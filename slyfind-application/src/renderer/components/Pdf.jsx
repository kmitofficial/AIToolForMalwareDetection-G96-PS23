import formatResult from "../result";
import Loader from "./Loader";
import { useState } from "react";

const Pdf = () => {
  const [resultDiv, setResultDiv] = useState("");
  const main = async (e) => {
    e.preventDefault();
    setResultDiv("");
    const input = document.querySelector(".file-input");
    input.style.display = "none";
    const loader = document.querySelector(".loader");
    loader.style.display = "block";
    let result;
    try {
      const file = document.getElementById("fileInput").files;
      result = await window.api.pdfanalyse(`"${file[0].path}"`);
      result = result.trim().slice(2, -2);
      setResultDiv(result);
      formatResult(result);
      setResultDiv(result);
      loader.style.display = "none";
      input.style.display = "block";
      console.log("done model test");
    } catch (error) {
      console.error(error);
    }
  };
  return (
    <div className="pdf">
      <h2>PDF Analysis</h2>
      <div className="file-input">
        <div className="ring">
          <i></i>
          <i></i>
          <i></i>
          <form id="fileForm" onSubmit={main}>
            <div className="login">
              <h3>Give Pdf File</h3>
              <div className="inputBx">
                <input
                  type="file"
                  id="fileInput"
                  name="fileInput"
                  accept=".pdf"
                />
              </div>
              <button type="submit">Submit</button>
            </div>
          </form>
        </div>
      </div>
      <Loader />
      <div className="result">{resultDiv}</div>
    </div>
  );
};

export default Pdf;
