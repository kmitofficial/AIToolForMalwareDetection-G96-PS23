import {
  Home,
  ScanSearch,
  BookOpenText,
  MessageSquareReply,
  Contact,
  Settings,
  ArrowLeft,
} from "lucide-react";
import { useEffect } from "react";
import { Link, Outlet, redirect, useNavigate } from "react-router-dom";
import active from "../active";
import Mode from "./Mode";

const NavBar = () => {
  const navigate = useNavigate();
  useEffect(() => {
    navigate("/malware-analysis");
  }, []);
  const backClicked = async (e) => {
    const path = e.target.ownerDocument.location.pathname;
    console.log(path);
    navigate(path.split("/").slice(1, -1).join("/"));
    if (path.split("/").length === 3) {
      document.querySelector(".back-button").style.display = "none";
    } else if (path.split("/").length === 4) {
      if (path.split("/")[2] === "memory-forensics") {
        document.querySelector(".mem-nav").classList.remove("transformed");
        document.querySelector(".mem-label.active").classList.remove("active");
        document.querySelectorAll(".mem-card").forEach((card) => {
          card.classList.remove("transform");
        });
      } else if (path.split("/")[2] === "network-intrusion") {
        document.querySelector(".net-nav").classList.remove("transformed");
        document.querySelector(".net-label.active").classList.remove("active");
        document.querySelectorAll(".net-card").forEach((card) => {
          card.classList.remove("transform");
        });
      }
    }
  };
  return (
    <div className="page">
      <div className="navbar">
        <button type="button" className="back-button" onClick={backClicked}>
          <ArrowLeft />
        </button>
        <div className="nav">
          <Link to="home" onClick={(e) => active(e)}>
            <span className="home-icon icon active">
              <Home strokeWidth={2.3} />
            </span>
            <div className="home-label label">Home</div>
          </Link>
          <Link to="/malware-analysis" onClick={(e) => active(e)}>
            <span className="mal-icon icon">
              <ScanSearch strokeWidth={2.3} />
            </span>
            <div className="mal-label label">Malware Analysis</div>
          </Link>
          <Link to="/resources" onClick={(e) => active(e)}>
            <span className="res-icon icon">
              <BookOpenText strokeWidth={2.3} />
            </span>
            <div className="res-label label">Educational Resources</div>
          </Link>
          <Link to="/feedback" onClick={(e) => active(e)}>
            <span className="feed-icon icon">
              <MessageSquareReply strokeWidth={2.3} />
            </span>
            <div className="feed-label label">Feedback</div>
          </Link>
          <Link to="/contact" onClick={(e) => active(e)}>
            <span className="con-icon icon">
              <Contact strokeWidth={2.3} />
            </span>
            <div className="con-label label">Contact</div>
          </Link>
          <Link to="/settings" onClick={(e) => active(e)}>
            <span className="set-icon icon">
              <Settings strokeWidth={2.3} />
            </span>
            <div className="set-label label">Settings</div>
          </Link>
        </div>
        <Mode />
      </div>
      <div id="detail">
        <Outlet />
      </div>
    </div>
  );
};

export default NavBar;
